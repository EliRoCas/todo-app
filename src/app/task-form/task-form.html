<div class="form-container" [formGroup]="taskForm">
  <div class="form-header">
    <h1 class="form-title">Create New Task</h1>
    <p class="form-subtitle">Break it down, get it done</p>
  </div>

  <form id="taskForm">
    <div>
      <label class="form-label required" for="taskName">Task Name</label>
      <input type="text" id="taskName" class="form-input" placeholder="What needs to be done?"
        formControlName="title" />
    </div>

    <div>
      <label class="form-label required">Priority</label>
      <div class="priority-buttons">
        <button type="button" class="priority-btn low" data-priority="low">
          <span>游릭</span> Low
        </button>
        <button type="button" class="priority-btn medium selected" data-priority="medium">
          <span>游리</span> Medium
        </button>
        <button type="button" class="priority-btn high" data-priority="high">
          <span>游댮</span> High
        </button>
      </div>
    </div>

    <app-panel>
      <div title class="flex justify-between items-center">
        Subtasks

        <button type="button" class="add-subtask-btn" (click)="addSubTask()">
          + Add Subtask
        </button>
      </div>

      <div class="subtasks-list">
        @for(subTask of subTasksForm.controls; track subTask){
        <div class="subtask-item" [formGroup]="toGroup(subTask)">
          <input type="text" class="subtask-input" placeholder="Subtask name..." formControlName="title" />
          <!-- <select class="subtask-priority low">
            <option value="low" selected>游릭 Low</option>
            <option value="medium">游리 Medium</option>
            <option value="high">游댮 High</option>
          </select> -->
          <button type="button" class="remove-subtask">칑</button>
        </div>
        }
      </div>
    </app-panel>

    <app-panel [isExpandable]="true">
      <ng-container title>
        Optional Settings
      </ng-container>

      <div class="optional-fields">
        <div class="form-group">
          <label class="form-label" for="deadline">Deadline</label>
          <input type="datetime-local" id="deadline" class="form-input" />
        </div>

        <div class="form-group">
          <label class="form-label">Focus Timer</label>
          <div class="timer-input">
            <input type="number" id="focusMinutes" class="form-input timer-number" min="1" max="180" value="25" />
            <span>minutes of focused work</span>
          </div>
        </div>
      </div>
    </app-panel>

    <div class="form-buttons">
      <button type="button" class="btn btn-secondary" (click)="dialogRef.close()">
        Cancel
      </button>
      <button type="submit" class="btn btn-primary" (click)="save($event)" [disabled]="taskForm.invalid">
        Create Task
      </button>
    </div>
  </form>
</div>